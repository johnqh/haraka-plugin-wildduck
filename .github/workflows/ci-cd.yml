---
# CI/CD workflow for haraka-plugin-wildduck
# Automatically publishes to NPM and Docker Hub based on configured secrets

name: CI/CD

on:
    push:
        branches:
            - master
            - develop
    pull_request:
        branches:
            - master
            - develop

permissions:
    contents: write # For creating GitHub releases
    id-token: write # For NPM provenance
    deployments: write # For deployment tracking

jobs:
    cicd:
        uses: johnqh/workflows/.github/workflows/unified-cicd.yml@main
        with:
            docker-image-name: 'haraka'
            npm-access: 'public'
        secrets: inherit  # Pass all repository secrets
